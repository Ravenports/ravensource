DEF[PORTVERSION]=	1.0.36
# ----------------------------------------------------------------------------

NAMEBASE=		tinc
VERSION=		${PORTVERSION}
REVISION=		3
KEYWORDS=		net security
VARIANTS=		std
SDESC[std]=		Virtual Private Network (VPN) daemon
HOMEPAGE=		https://tinc-vpn.org/
CONTACT=		nobody

DOWNLOAD_GROUPS=	main
SITES[main]=		https://tinc-vpn.org/packages/
DISTFILE[1]=		tinc-${PORTVERSION}.tar.gz:main

SPKGS[std]=		set primary man info

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

LICENSE=		GPLv3+:primary
LICENSE_FILE=		GPLv3+:stock
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_AWK=		TERMS:"^\#include"
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/src/bsd/tunemu.c
LICENSE_SCHEME=		solo

FPC_EQUIVALENT=		security/tinc

USERS=			tinc
GROUPS=			tinc
USERGROUP_SPKG=		primary
RC_SUBR=		tincd:primary

USES=			cpe makeinfo ssl zlib lzo
			smf:primary
CPE_VENDOR=		tinc-vpn
SMF_METHODS=		tinc_command.sh
MUST_CONFIGURE=		gnu
CONFIGURE_ARGS=		--localstatedir={{PREFIX}}/var
INFO=			info:tinc
SUB_FILES=		manifest.xml
			tinc_command.sh
SUB_LIST=		TINC_USR={{USERS}}
			TINC_GRP={{GROUPS}}
			MSCRIPT="{{PREFIX}}/lib/svc/method/tinc_command.sh"
PLIST_SUB=		OWN={{USERS}}
			GRP={{GROUPS}}

post-install:
	${MKDIR} ${STAGEDIR}${PREFIX}/var/run/tinc
	${MKDIR} ${STAGEDIR}${PREFIX}/var/log/tinc
	${MKDIR} ${STAGEDIR}${PREFIX}/etc/tinc/default/hosts
	${INSTALL_DATA} ${FILESDIR}/tinc.conf.sample ${STAGEDIR}${PREFIX}/etc/tinc/default
