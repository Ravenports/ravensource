DEF[PORTVERSION]=	2.3.1
# ----------------------------------------------------------------------------

NAMEBASE=		tree
VERSION=		${PORTVERSION}
KEYWORDS=		sysutils
VARIANTS=		std
SDESC[std]=		Display tree-view of directories
HOMEPAGE=		https://gitlab.com/OldManProgrammer/unix-tree
CONTACT=		Michael_Reim[kraileth@elderlinux.org]

DOWNLOAD_GROUPS=	main
SITES[main]=		https://gitlab.com/OldManProgrammer/unix-tree/-/archive/${PORTVERSION}/
DISTFILE[1]=		unix-tree-${PORTVERSION}.tar.gz:main

SPKGS[std]=		set primary man

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

FPC_EQUIVALENT=		sysutils/tree

LICENSE=		GPLv2+:primary
LICENSE_FILE=		GPLv2+:{{WRKSRC}}/LICENSE
LICENSE_TERMS=		primary:{{WRKDIR}}/TERMS
LICENSE_SOURCE=		TERMS:{{WRKSRC}}/tree.h
LICENSE_AWK=		TERMS:"^$$"
LICENSE_SCHEME=		solo

USES=			gmake
DISTNAME=		unix-tree-${PORTVERSION}

VAR_OPSYS[sunos]=	CFLAGS=-D__EXTENSIONS__

pre-configure:
	${REINPLACE_CMD} -e 's|__TARGET__|${PREFIX}/share/xsl/docbook/manpages|' \
		${WRKSRC}/Makefile
	# avoid definition conflict with <pwd.h> on solaris
	${REINPLACE_CMD} -e 's|struct comment|struct opinion|g' \
		${WRKSRC}/info.c \
		${WRKSRC}/tree.c \
		${WRKSRC}/file.c \
		${WRKSRC}/tree.h

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/tree ${STAGEDIR}${PREFIX}/bin
	${INSTALL_MAN} ${WRKSRC}/doc/*.1 ${STAGEDIR}${MAN1PREFIX}/man/man1
