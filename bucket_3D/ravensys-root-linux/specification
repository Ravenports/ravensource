DEF[PRIME]=		3.2.0
DEF[X_CURRENT]=		EXTRACT_VERSION(PLATFORM_Linux_x86-64)
DEF[ABI32_FILES_1]=	2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26
DEF[ABI32_FILES_2]=	27 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51
DEF[ABI32_FILES]=	${ABI32_FILES_1} ${ABI32_FILES_2}
# ----------------------------------------------------------------------------

NAMEBASE=		ravensys-root-linux
VERSION=		${PRIME}
REVISION=		10
KEYWORDS=		raven
VARIANTS=		std
SDESC[std]=		Linux ${PRIME} builder system root
HOMEPAGE=		none
CONTACT=		John_Marino[draco@marino.st]

DOWNLOAD_GROUPS=	main leaf debian2 debian3 debian6 debian7
			debian8 debian9 debian10 debian11 debian12 debian13 debian14
			debian16 debian18 debian19 debian20 debian21
			debian22 debian24 debian25 debian26 debian27 debian28 debian29
			debian30
SITES[main]=		https://leaf.dragonflybsd.org/~marino/dports-src/
SITES[leaf]=		https://leaf.dragonflybsd.org/~marino/raven-distfiles/linux-61-sysroot/

SITES[debian2]=		DEBIAN/pool/main/a/attr
SITES[debian3]=		DEBIAN/pool/main/a/acl
SITES[debian6]=		DEBIAN/pool/main/h/hostname
SITES[debian7]=		DEBIAN/pool/main/d/dash
SITES[debian8]=		DEBIAN/pool/main/s/shadow
SITES[debian9]=		DEBIAN/pool/main/p/pax
SITES[debian10]=	DEBIAN/pool/main/libx/libxcrypt
SITES[debian11]=	DEBIAN/pool/main/libn/libnsl
SITES[debian12]=	DEBIAN/pool/main/libt/libtirpc
SITES[debian13]=	DEBIAN/pool/main/libn/libnss-nis
SITES[debian14]=	DEBIAN/pool/main/libn/libnss-nisplus
SITES[debian16]=	DEBIAN/pool/main/g/gnu-which
SITES[debian18]=	DEBIAN/pool/main/e/e2fsprogs
SITES[debian19]=	DEBIAN/pool/main/k/keyutils
SITES[debian20]=	DEBIAN/pool/main/libb/libbsd
SITES[debian21]=	DEBIAN/pool/main/libm/libmd
SITES[debian22]=	DEBIAN/pool/main/libn/libnl3
SITES[debian24]=	DEBIAN/pool/main/libz/libzstd
SITES[debian25]=	DEBIAN/pool/main/l/lz4
SITES[debian26]=	DEBIAN/pool/main/x/xz-utils
SITES[debian27]=	DEBIAN/pool/main/libg/libgcrypt20
SITES[debian28]=	DEBIAN/pool/main/libg/libgpg-error
SITES[debian29]=	DEBIAN/pool/main/libc/libcap2
SITES[debian30]=	DEBIAN/pool/main/t/tzdata

DISTFILE[1]=		dummy-tarball.tar.gz:main
DISTFILE[2]=		locales_2.36-9+deb12u1_all.deb:leaf
DISTFILE[3]=		libc6-dev_2.36-9+deb12u1_amd64.deb:leaf
DISTFILE[4]=		libc6_2.36-9+deb12u1_amd64.deb:leaf
DISTFILE[5]=		libc-bin_2.36-9+deb12u1_amd64.deb:leaf
DISTFILE[6]=		libattr1-dev_2.5.1-4_amd64.deb:debian2
DISTFILE[7]=		libattr1_2.5.1-4_amd64.deb:debian2
DISTFILE[8]=		libacl1-dev_2.3.1-3_amd64.deb:debian3
DISTFILE[9]=		libacl1_2.3.1-3_amd64.deb:debian3
DISTFILE[10]=		libudev-dev_252.12-1~deb12u1_amd64.deb:leaf
DISTFILE[11]=		libudev1_252.12-1~deb12u1_amd64.deb:leaf
DISTFILE[12]=		linux-libc-dev_6.1.38-4_amd64.deb:leaf
DISTFILE[13]=		libcrypt-dev_4.4.33-2_amd64.deb:debian10
DISTFILE[14]=		libcrypt1_4.4.33-2_amd64.deb:debian10
DISTFILE[15]=		libnsl-dev_1.3.0-2_amd64.deb:debian11
DISTFILE[16]=		libnsl2_1.3.0-2_amd64.deb:debian11
DISTFILE[17]=		libtirpc-dev_1.3.3+ds-1_amd64.deb:debian12
DISTFILE[18]=		libtirpc3_1.3.3+ds-1_amd64.deb:debian12
DISTFILE[19]=		libnss3-dev_3.87.1-1_amd64.deb:leaf
DISTFILE[20]=		libnss3_3.87.1-1_amd64.deb:leaf
DISTFILE[21]=		gnu-which_2.21+dfsg-2_amd64.deb:debian16
DISTFILE[22]=		hostname_3.23+nmu1_amd64.deb:debian6
DISTFILE[23]=		dash_0.5.12-2_amd64.deb:debian7
DISTFILE[24]=		passwd_4.13+dfsg1-1+b1_amd64.deb:debian8
DISTFILE[25]=		pax_20201030-1_amd64.deb:debian9
DISTFILE[26]=		libnss-nis_3.1-4_amd64.deb:debian13
DISTFILE[27]=		libnss-nisplus_1.3-4_amd64.deb:debian14
DISTFILE[28]=		ld.so.cache.tar.gz:leaf
DISTFILE[29]=		locale-archive.tar.zst:leaf
DISTFILE[30]=		libgssapi-krb5-2_1.20.1-2_amd64.deb:leaf
DISTFILE[31]=		libkrb5-3_1.20.1-2_amd64.deb:leaf
DISTFILE[32]=		libk5crypto3_1.20.1-2_amd64.deb:leaf
DISTFILE[33]=		libkrb5support0_1.20.1-2_amd64.deb:leaf
DISTFILE[34]=		libcom-err2_1.47.0-2_amd64.deb:debian18
DISTFILE[35]=		libkeyutils1_1.6.3-2_amd64.deb:debian19
DISTFILE[36]=		libbsd0_0.11.7-2_amd64.deb:debian20
DISTFILE[37]=		libmd0_1.0.4-2_amd64.deb:debian21
DISTFILE[38]=		libnl-genl-3-dev_3.7.0-0.2+b1_amd64.deb:debian22
DISTFILE[39]=		libnl-genl-3-200_3.7.0-0.2+b1_amd64.deb:debian22
DISTFILE[40]=		libnl-3-dev_3.7.0-0.2+b1_amd64.deb:debian22
DISTFILE[41]=		libnl-3-200_3.7.0-0.2+b1_amd64.deb:debian22
DISTFILE[42]=		libsystemd-dev_252.12-1~deb12u1_amd64.deb:leaf
DISTFILE[43]=		libsystemd0_247.3-7+deb11u2_amd64.deb:leaf
DISTFILE[44]=		libzstd1_1.5.4+dfsg2-5_amd64.deb:debian24
DISTFILE[45]=		liblz4-1_1.9.4-1_amd64.deb:debian25
DISTFILE[46]=		liblzma5_5.4.1-0.2_amd64.deb:debian26
DISTFILE[47]=		libgcrypt20_1.10.1-3_amd64.deb:debian27
DISTFILE[48]=		libgpg-error0_1.46-1_amd64.deb:debian28
DISTFILE[49]=		libcap2_2.66-4_amd64.deb:debian29
DISTFILE[50]=		libcap-dev_2.66-4_amd64.deb:debian29
DISTFILE[51]=		tzdata_2025b-0+deb12u2_all.deb:debian30

DIST_SUBDIR=		linux-sysroot
DF_INDEX=		${ABI32_FILES} 28 29

SPKGS[std]=		single

OPTIONS_AVAILABLE=	none
OPTIONS_STANDARD=	none

ONLY_FOR_OPSYS=		linux

INVALID_RPATH=		yes

BUILD_DEPENDS=		nawk:primary:std
			diffutils:primary:ravensys
			libarchive:primary:static
			gnugrep:primary:ravensys
			file:primary:ravensys
			findutils:primary:ravensys
			flex:primary:ravensys
			gzip:primary:std
			xz:tools:std
			unzip:primary:std
			m4:primary:noprefix
			sed:primary:ravensys
			byacc:primary:std
			less:primary:std
			nvi:primary:std
			coreutils:primary:ravensys
			ravensys-binutils:single:std
			ncurses:terminfo:std
			rvn:primary:std
			mandoc:primary:std
			genpatch:primary:std
			fetch:primary:std
			ccache:primary:std
			bzip2:tools:std
			shadow:single:std
			bash:primary:static
			bmake:primary:std
			ravensys-utils:primary:std

SKIP_BUILD=		yes
SINGLE_JOB=		yes
EXTRACT_DIRTY=		${ABI32_FILES} 28 29
EXTRACT_DEB_PACKAGE=	${ABI32_FILES}
PLIST_SUB=		BASE={{SYSPATH}}
INFRASTRUCTURE=		yes

MAKE_ENV=		OPSYS="{{OPSYS}}"
			ARCH="{{ARCH}}"
			ARCHSTD="{{ARCH_STANDARD}}"
			OSVERSION="{{OSVERSION}}"
			OSREL="{{OSREL}}"
			OSMAJOR="{{MAJOR}}"
			MKDIR="{{MKDIR}}"
			GCCX=ravensys-gcc
MAKE_ARGS=		BASE={{RSYS}}

VAR_OPSYS[linux]=	MAKEFILE_LINE=SYSTEM=${X_CURRENT}

pre-fetch:
	${SH} ${MK_SCRIPTS}/ravensys-root-validate_pkgs.sh ${PREFIX} \
		${OPSYS} ${ARCH} ${ARCH_STANDARD} ${OSVERSION} ${OSREL} ${MAJOR}

post-extract:
	${MKDIR} ${WRKSRC} ${WRKDIR}/linux
	${INSTALL_DATA} ${MK_SCRIPTS}/ravensys-root-Makefile ${WRKSRC}/Makefile
	${INSTALL_DATA} ${FILESDIR}/linux61.mk ${WRKSRC}/system_specifics.mk
.for NDX in ${ABI32_FILES}
	@echo "copy ${NAMEBASE}_${NDX} files over"
	@cp -a ${WRKDIR}/${NAMEBASE}_${NDX}/* ${WRKDIR}/linux/
	@${RM} -r ${WRKDIR}/${NAMEBASE}_${NDX}
.endfor
