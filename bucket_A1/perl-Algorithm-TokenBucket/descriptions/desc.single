Token bucket rate limiting algorithm

